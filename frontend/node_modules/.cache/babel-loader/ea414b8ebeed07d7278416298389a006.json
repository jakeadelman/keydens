{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _parseFloat from \"@babel/runtime-corejs2/core-js/parse-float\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nimport { useState } from \"react\";\nimport axios from \"axios\";\nimport Spinner from \"./Loader\";\n\nvar Cookies = require(\"js-cookie\");\n\nvar CryptoJS = require(\"crypto-js\");\n\nexport default function Search() {\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      keyword = _useState2[0],\n      editKeyword = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      tooMany = _useState4[0],\n      setTooMany = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      wordTooMany = _useState6[0],\n      setWordTooMany = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      loading = _useState8[0],\n      setLoading = _useState8[1];\n\n  var _useState9 = useState(),\n      _useState10 = _slicedToArray(_useState9, 2),\n      data = _useState10[0],\n      setData = _useState10[1];\n\n  var _useState11 = useState(),\n      _useState12 = _slicedToArray(_useState11, 2),\n      isData = _useState12[0],\n      setIsData = _useState12[1];\n\n  function sub() {\n    return _sub.apply(this, arguments);\n  }\n\n  function _sub() {\n    _sub = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var cookieExists, ciphertext, formattedKw, getStr, kwArray, i, newText, _ciphertext, _formattedKw, _getStr;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setTooMany(false);\n              setWordTooMany(false);\n              cookieExists = get();\n\n              if (!(cookieExists == false)) {\n                _context.next = 13;\n                break;\n              }\n\n              ciphertext = CryptoJS.AES.encrypt(keyword, \"//secr/k!!\");\n              Cookies.set(\"wrds\", ciphertext, {\n                expires: 0.02083333333\n              });\n              console.log(\"fetching\");\n              formattedKw = keyword.split(\" \").join(\"+\");\n              getStr = \"http://localhost:4000/keyword/\" + formattedKw;\n              setLoading(true);\n              fetch(getStr);\n              _context.next = 34;\n              break;\n\n            case 13:\n              kwArray = cookieExists.split(\"+\");\n              console.log(kwArray);\n              i = 0;\n\n            case 16:\n              if (!(i < kwArray.length)) {\n                _context.next = 24;\n                break;\n              }\n\n              if (!(keyword == kwArray[i])) {\n                _context.next = 21;\n                break;\n              }\n\n              console.log(\"word found\");\n              setWordTooMany(true);\n              return _context.abrupt(\"return\");\n\n            case 21:\n              i++;\n              _context.next = 16;\n              break;\n\n            case 24:\n              if (!(kwArray.length >= 5)) {\n                _context.next = 27;\n                break;\n              }\n\n              setTooMany(true);\n              return _context.abrupt(\"return\");\n\n            case 27:\n              newText = cookieExists + \"+\" + keyword;\n              _ciphertext = CryptoJS.AES.encrypt(newText, \"//secr/k!!\");\n              Cookies.set(\"wrds\", _ciphertext, {\n                expires: 0.02083333333\n              });\n              setLoading(true);\n              _formattedKw = keyword.split(\" \").join(\"+\");\n              _getStr = \"http://localhost:4000/keyword/\" + _formattedKw;\n              fetch(_getStr);\n\n            case 34:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _sub.apply(this, arguments);\n  }\n\n  function fetch(getStr) {\n    axios.get(getStr).then(function (response) {\n      var dens = _parseFloat(response.data.density);\n\n      dens = dens.toFixed(2);\n      dens = dens.toString();\n\n      var wrds = _parseInt(response.data.words);\n\n      wrds = wrds.toString();\n\n      var times = _parseFloat(response.data.count);\n\n      times = times.toFixed(2);\n      times = times.toString();\n      var newDat = {};\n      newDat[\"density\"] = dens;\n      newDat[\"words\"] = wrds;\n      newDat[\"count\"] = times;\n      console.log(newDat);\n      setData(newDat);\n      setIsData(true);\n      setLoading(false);\n      console.log(response);\n    });\n  }\n\n  function get() {\n    var text = Cookies.get(\"wrds\");\n\n    if (text == undefined) {\n      return false;\n    } else {\n      var bytes = CryptoJS.AES.decrypt(text.toString(), \"//secr/k!!\");\n      var plaintext = bytes.toString(CryptoJS.enc.Utf8);\n      console.log(plaintext);\n      return plaintext;\n    }\n  }\n\n  function searchAgain() {\n    setIsData(false);\n  }\n\n  function decrypt(_x) {\n    return _decrypt.apply(this, arguments);\n  }\n\n  function _decrypt() {\n    _decrypt = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(text) {\n      var bytes, plaintext;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              bytes = CryptoJS.AES.decrypt(text.toString(), \"//secr/k!!\");\n              plaintext = bytes.toString(CryptoJS.enc.Utf8);\n              return _context2.abrupt(\"return\", plaintext);\n\n            case 3:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _decrypt.apply(this, arguments);\n  }\n\n  if (!loading && !isData) {\n    return React.createElement(\"div\", {\n      className: \"outer-search-wrap\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-2851148752\" + \" \" + \"inner-search-wrap\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-2851148752\" + \" \" + \"search-title\"\n    }, React.createElement(\"strong\", {\n      className: \"jsx-2851148752\"\n    }, \"enter your keyword\")), React.createElement(\"div\", {\n      className: \"jsx-2851148752\" + \" \" + \"searchbar-wrap\"\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      onChange: function onChange(e) {\n        return editKeyword(e.target.value);\n      },\n      className: \"jsx-2851148752\" + \" \" + \"keyword-input\"\n    }), React.createElement(\"button\", {\n      onClick: sub,\n      className: \"jsx-2851148752\" + \" \" + \"search-button\"\n    }, \"Get Metrics\")), !!wordTooMany ? React.createElement(\"div\", {\n      className: \"jsx-2851148752\" + \" \" + \"alert-bar\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-2851148752\" + \" \" + \"inner-alert\"\n    }, \"You can only search the same keyword once every 30 mins. Try another keyword.\")) : null, !!tooMany ? React.createElement(\"div\", {\n      className: \"jsx-2851148752\" + \" \" + \"alert-bar\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-2851148752\" + \" \" + \"inner-alert\"\n    }, \"You only have 5 searches every 30 mins. Please try again later.\")) : null, React.createElement(_JSXStyle, {\n      id: \"2851148752\"\n    }, [\"div.alert-bar.jsx-2851148752{max-width:200px;font-size:12px;padding:5px;margin:12px;border:1px solid #e22b2e;}\", \"div.inner-search-wrap.jsx-2851148752{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:15px;}\", \"div.outer-search-wrap.jsx-2851148752{padding:10px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}\", \"div.search-title.jsx-2851148752{margin:auto;margin-bottom:14px;}\", \"button.search-button.jsx-2851148752{border-radius:0;border:none;padding:8px;font-size:10px;background-color:#e22b2e;color:#fff;text-transform:uppercase;-webkit-letter-spacing:1.5px;-moz-letter-spacing:1.5px;-ms-letter-spacing:1.5px;letter-spacing:1.5px;font-weight:700;}\", \".search-button.jsx-2851148752:hover{background:#fff;color:#000;box-shadow:0 12px 60px 0 #e22b2e;}\", \"div.searchbar-wrap.jsx-2851148752{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}\", \"input.keyword-input.jsx-2851148752{font-size:13px;}\"])));\n  } else if (!!loading) {\n    return React.createElement(\"div\", {\n      className: \"outer-search-wrap\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-3598683652\" + \" \" + \"inner-search-wrap\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-3598683652\" + \" \" + \"search-title\"\n    }, React.createElement(\"strong\", {\n      className: \"jsx-3598683652\"\n    }, \"fetching data for top 50 results...\", React.createElement(\"br\", {\n      className: \"jsx-3598683652\"\n    }), \" this could take a minute.\")), React.createElement(\"div\", {\n      className: \"jsx-3598683652\" + \" \" + \"loading-wrap\"\n    }, React.createElement(Spinner, null)), React.createElement(_JSXStyle, {\n      id: \"3598683652\"\n    }, [\"div.inner-search-wrap.jsx-3598683652{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:15px;}\", \"div.outer-search-wrap.jsx-3598683652{padding:10px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}\", \"div.search-title.jsx-3598683652{margin:auto;margin-bottom:10px;text-align:center;margin-bottom:5px;}\", \"button.search-button.jsx-3598683652{border-radius:0;border:none;padding:8px;font-size:10px;background-color:#e22b2e;color:#fff;text-transform:uppercase;-webkit-letter-spacing:1.5px;-moz-letter-spacing:1.5px;-ms-letter-spacing:1.5px;letter-spacing:1.5px;font-weight:700;}\", \".search-button.jsx-3598683652:hover{background:#fff;color:#000;box-shadow:0 12px 60px 0 #e22b2e;}\", \"div.loading-wrap.jsx-3598683652{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}\", \"input.keyword-input.jsx-3598683652{font-size:13px;}\"])));\n  } else {\n    return React.createElement(\"div\", {\n      className: \"jsx-2104774507\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-2104774507\" + \" \" + \"outer-data-wrap\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-2104774507\" + \" \" + \"data-search-wrap\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-2104774507\" + \" \" + \"search-title\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-2104774507\"\n    }, \"results for \", React.createElement(\"strong\", {\n      className: \"jsx-2104774507\"\n    }, keyword))), React.createElement(\"div\", {\n      className: \"jsx-2104774507\" + \" \" + \"data-wrap\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-2104774507\" + \" \" + \"data-row\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-2104774507\" + \" \" + \"data-dat\"\n    }, \"kw density\"), React.createElement(\"div\", {\n      className: \"jsx-2104774507\" + \" \" + \"data-dat-right\"\n    }, data.density, \"%\")), React.createElement(\"div\", {\n      className: \"jsx-2104774507\" + \" \" + \"data-row-2\"\n    }, React.createElement(\"div\", {\n      className: \"jsx-2104774507\" + \" \" + \"data-dat\"\n    }, \"avg wordcount\"), React.createElement(\"div\", {\n      className: \"jsx-2104774507\" + \" \" + \"data-dat-right\"\n    }, data.words))), React.createElement(\"div\", {\n      className: \"jsx-2104774507\" + \" \" + \"search-again-wrap\"\n    }, React.createElement(\"button\", {\n      onClick: searchAgain,\n      className: \"jsx-2104774507\" + \" \" + \"search-button\"\n    }, \"search again\")))), React.createElement(_JSXStyle, {\n      id: \"2104774507\"\n    }, [\".sub-search-title.jsx-2104774507{font-size:10px;}\", \"div.data-wrap.jsx-2104774507{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border:1px solid rgba(0,0,0,0.5);margin:12px 0;}\", \".search-again-wrap.jsx-2104774507{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}\", \"div.data-row.jsx-2104774507{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;max-width:100%;padding:5px;}\", \"div.data-row-2.jsx-2104774507{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;max-width:100%;border-top:1px solid rgba(0,0,0,0.5);padding:5px;}\", \"div.data-dat.jsx-2104774507{width:50%;}\", \"div.data-dat-right.jsx-2104774507{width:50%;text-align:right;}\", \"div.data-search-wrap.jsx-2104774507{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:15px;max-width:100%;}\", \".outer-data-wrap.jsx-2104774507{padding:10px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-width:300px;}\", \"div.search-title.jsx-2104774507{margin:auto;margin-bottom:10px;text-align:center;margin-bottom:5px;}\", \"button.search-button.jsx-2104774507{border-radius:0;border:none;padding:8px;font-size:10px;background-color:#e22b2e;color:#fff;text-transform:uppercase;-webkit-letter-spacing:1.5px;-moz-letter-spacing:1.5px;-ms-letter-spacing:1.5px;letter-spacing:1.5px;font-weight:700;margin:auto;}\", \".search-button.jsx-2104774507:hover{background:#fff;color:#e22b2e;border:1px solid #e22b2e;box-shadow:0 4px 10px 0 rgba(0,0,0,0.4);}\", \"div.loading-wrap.jsx-2104774507{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}\", \"input.keyword-input.jsx-2104774507{font-size:13px;}\"]));\n  }\n}","map":null,"metadata":{},"sourceType":"module"}